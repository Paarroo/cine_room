<div class="dashboard-header">
  <div class="admin-welcome-section">
    <h1 class="admin-welcome-title">
      Bonjour Admin !
    </h1>
    <p class="admin-welcome-subtitle">
      Tableau de bord CinéRoom - 22 juillet 2025
    </p>
    <!-- Quick Action Buttons -->
    <div class="admin-welcome-actions">
      <a href="/admin_movies_path" class="admin-welcome-btn-primary">Nouveau Film</a>
      <a href="/admin_events_path" class="admin-welcome-btn-secondary">Nouvel Événement</a>
    </div>
  </div>
</div>

<!-- Key Metrics Section -->
<div class="metrics-section">
  <h2 class="admin-metrics-title">
    Métriques Clés
  </h2>

  <div class="admin-metrics-grid">

    <!-- Revenue Metric Card -->
    <div class="admin-metric-card">
      <div class="admin-metric-header">
        <div class="admin-metric-icon admin-metric-icon-gold">
          <i class="fas fa-euro-sign"></i>
        </div>
      </div>

      <div class="admin-metric-value admin-metric-value-gradient">
        <%= number_to_currency(@metrics[:total_revenue]) %>
      </div>
      <div class="admin-metric-label">Revenus Total</div>
      <div class="admin-metric-sublabel">
        Ce mois
      </div>
    </div>

    <!-- Active Events Metric Card -->
    <div class="admin-metric-card">
      <div class="admin-metric-header-simple">
        <div class="admin-metric-icon admin-metric-icon-blue">
          <i class="fas fa-calendar-alt"></i>
        </div>
      </div>

      <div class="admin-metric-value admin-metric-value-blue">
        <%= @metrics[:upcoming_events] %>
      </div>
      <div class="admin-metric-label">Événements Actifs</div>
      <div class="admin-metric-sublabel">
        <%= Event.where(status: :sold_out).count %> complets
      </div>
    </div>

    <!-- Users Metric Card -->
    <div class="admin-metric-card">
      <div class="admin-metric-header-simple">
        <div class="admin-metric-icon admin-metric-icon-green">
          <i class="fas fa-users"></i>
        </div>
      </div>

      <div class="admin-metric-value admin-metric-value-green">
        <%= @metrics[:total_users] %>
      </div>
      <div class="admin-metric-label">Utilisateurs Total</div>
      <div class="admin-metric-sublabel">
        <%= Participation.joins(:user).distinct.count('users.id') %> actifs
      </div>
    </div>

    <!-- Satisfaction Metric Card -->
    <div class="admin-metric-card">
      <div class="admin-metric-header-simple">
        <div class="admin-metric-icon admin-metric-icon-gold">
          <i class="fas fa-star"></i>
        </div>
      </div>

      <div class="admin-metric-value admin-metric-value-gold">
        <%= @metrics[:satisfaction] %>/5
      </div>
      <div class="admin-metric-label">Satisfaction</div>
      <div class="admin-metric-sublabel">
        <%= Review.count %> avis
      </div>
    </div>
  </div>
</div>

<!-- Management Section with Pending Movies and Recent Activity -->
<div class="management-section">
  <div class="admin-content-grid">

    <!-- Pending Movies Panel -->
    <div class="panel">
      <h3 class="admin-section-title admin-section-title-gold">Films en Attente de Validation</h3>

      <% if @pending_movies.any? %>
        <div class="admin-pending-list">
          <% @pending_movies.each do |movie| %>
            <div class="admin-pending-item">
              <!-- Movie Info -->
              <div class="admin-pending-info">
                <h4>
                  <%= movie.title %>
                </h4>
                <div class="director">
                  <%= movie.director %> • <%= movie.year %>
                </div>
                <div class="date">
                  Par <%= movie.user&.full_name || 'Créateur inconnu' %>
                </div>
              </div>

              <!-- Action Buttons -->
              <div class="admin-pending-actions">
                <%= link_to "Voir", admin_movie_path(movie), class: "admin-action-button" %>
              </div>
            </div>
          <% end %>
        </div>

        <div class="admin-pending-more">
          <%= link_to "Voir tous les films en attente",
              admin_movies_path + "?q[validation_status_eq]=pending",
              class: "text-gold-500 hover:text-gold-400 transition-colors" %>
        </div>
      <% else %>
        <div class="admin-no-pending">
          <i class="fas fa-check-circle"></i>
          <div>Aucun film en attente de validation</div>
        </div>
      <% end %>
    </div>

    <!-- Recent Activity Panel -->
    <div class="panel">
      <h3 class="admin-section-title admin-section-title-blue">Activité Récente</h3>

      <div class="admin-activity-list">
        <% @recent_activities.each do |activity| %>
          <div class="admin-activity-item">
            <div class="admin-activity-icon">
              <i class="fas fa-<%= activity[:icon] %>"></i>
            </div>

            <div class="admin-activity-content">
              <div class="admin-activity-text">
                <%= activity[:title] %>
              </div>
              <div class="admin-activity-description">
                <%= activity[:description] %>
              </div>
            </div>

            <div class="admin-activity-time">
              <%= activity[:time_ago] %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>

<!-- Quick Actions Section -->
<div class="quick-actions">
  <h3 class="admin-quick-actions-title">Actions Rapides</h3>

  <div class="admin-quick-actions-grid">

    <!-- Movies Management Action -->
    <%= link_to admin_movies_path, class: "admin-quick-action-link" do %>
      <div class="admin-quick-action-item">
        <div class="admin-quick-action-icon admin-quick-action-icon-gold">
          <i class="fas fa-film"></i>
        </div>
        <div class="admin-quick-action-text">
          <h4>Gérer Films</h4>
          <p>
            <%= @quick_stats[:pending_movies] %> en attente
          </p>
        </div>
      </div>
    <% end %>

    <!-- Events Management Action -->
    <%= link_to admin_events_path, class: "admin-quick-action-link" do %>
      <div class="admin-quick-action-item">
        <div class="admin-quick-action-icon admin-quick-action-icon-blue">
          <i class="fas fa-calendar-alt"></i>
        </div>
        <div class="admin-quick-action-text">
          <h4>Événements</h4>
          <p>
            <%= @quick_stats[:upcoming_events] %> à venir
          </p>
        </div>
      </div>
    <% end %>

    <!-- Users Management Action -->
    <%= link_to admin_users_path, class: "admin-quick-action-link" do %>
      <div class="admin-quick-action-item">
        <div class="admin-quick-action-icon admin-quick-action-icon-green">
          <i class="fas fa-users"></i>
        </div>
        <div class="admin-quick-action-text">
          <h4>Utilisateurs</h4>
          <p>
            <%= @quick_stats[:total_users] %> total
          </p>
        </div>
      </div>
    <% end %>

    <!-- Participations Management Action -->
    <%= link_to admin_participations_path, class: "admin-quick-action-link" do %>
      <div class="admin-quick-action-item">
        <div class="admin-quick-action-icon admin-quick-action-icon-gold">
          <i class="fas fa-ticket-alt"></i>
        </div>
        <div class="admin-quick-action-text">
          <h4>Participations</h4>
          <p>
            <%= Participation.count %> total
          </p>
        </div>
      </div>
    <% end %>

  </div>
</div>
