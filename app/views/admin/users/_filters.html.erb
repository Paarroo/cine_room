<section class="filters-section py-6">
  <div class="container-app">
    <div class="glass-effect rounded-3xl p-6">
      <div class="flex items-center justify-between mb-6">
        <h3 class="text-xl font-bold text-white">
          <i class="fas fa-filter text-primary mr-2"></i>
          Filtres et Recherche
        </h3>

        <!-- Clear Filters Button -->
        <%= link_to admin_users_path,
            class: "px-4 py-2 bg-red-500/20 hover:bg-red-500/30 text-red-400 rounded-lg text-sm transition-colors" do %>
          <i class="fas fa-times mr-2"></i>Effacer les filtres
        <% end %>
      </div>

      <!-- Search and Filter Form -->
      <%= form_with url: admin_users_path, method: :get,
          class: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",
          data: { turbo_frame: "_top" } do |form| %>

        <!-- Search by Name/Email -->
        <div class="form-group">
          <%= form.label :q, "Recherche", class: "block text-sm font-medium text-gray-300 mb-2" %>
          <%= form.text_field :q,
              value: params[:q],
              placeholder: "Nom, email...",
              class: "form-input" %>
        </div>

        <!-- Filter by Role -->
        <div class="form-group">
          <%= form.label :role, "Rôle", class: "block text-sm font-medium text-gray-300 mb-2" %>
          <%= form.select :role,
              options_for_select([
                ['Tous les rôles', ''],
                ['Utilisateur', 'user'],
                ['Créateur', 'creator'],
                ['Administrateur', 'admin']
              ], params[:role]),
              {},
              { class: "form-input" } %>
        </div>

        <!-- Filter by Creator Status -->
        <div class="form-group">
          <%= form.label :creator_status, "Statut créateur", class: "block text-sm font-medium text-gray-300 mb-2" %>
          <%= form.select :creator_status,
              options_for_select([
                ['Tous', ''],
                ['Avec films', 'with_movies'],
                ['Sans films', 'without_movies']
              ], params[:creator_status]),
              {},
              { class: "form-input" } %>
        </div>

        <!-- Filter by Activity -->
        <div class="form-group">
          <%= form.label :activity, "Activité", class: "block text-sm font-medium text-gray-300 mb-2" %>
          <%= form.select :activity,
              options_for_select([
                ['Tous', ''],
                ['Actifs (avec réservations)', 'active'],
                ['Inactifs (sans réservations)', 'inactive']
              ], params[:activity]),
              {},
              { class: "form-input" } %>
        </div>

        <!-- Created Since -->
        <div class="form-group">
          <%= form.label :created_since, "Inscrit depuis", class: "block text-sm font-medium text-gray-300 mb-2" %>
          <%= form.date_field :created_since,
              value: params[:created_since],
              class: "form-input" %>
        </div>

        <!-- Sort Options -->
        <div class="form-group">
          <%= form.label :sort, "Trier par", class: "block text-sm font-medium text-gray-300 mb-2" %>
          <%= form.select :sort,
              options_for_select([
                ['Plus récent', 'created_at_desc'],
                ['Plus ancien', 'created_at_asc'],
                ['Nom A-Z', 'name_asc'],
                ['Nom Z-A', 'name_desc'],
                ['Email A-Z', 'email_asc']
              ], params[:sort]),
              {},
              { class: "form-input" } %>
        </div>

        <!-- Submit Button -->
        <div class="form-group col-span-full flex justify-start">
          <%= form.submit "Appliquer les filtres",
              class: "btn-primary" %>
        </div>
      <% end %>

      <!-- Active Filters Display -->
      <% if params.slice(:q, :role, :creator_status, :activity, :created_since).values.any?(&:present?) %>
        <div class="mt-6 pt-4 border-t border-white/10">
          <div class="flex items-center flex-wrap gap-2">
            <span class="text-sm text-gray-400 mr-2">Filtres actifs :</span>

            <% if params[:q].present? %>
              <span class="px-3 py-1 bg-primary/20 text-primary rounded-full text-xs">
                Recherche: "<%= params[:q] %>"
              </span>
            <% end %>

            <% if params[:role].present? %>
              <span class="px-3 py-1 bg-blue-500/20 text-blue-400 rounded-full text-xs">
                Rôle: <%= params[:role].humanize %>
              </span>
            <% end %>

            <% if params[:creator_status].present? %>
              <span class="px-3 py-1 bg-green-500/20 text-green-400 rounded-full text-xs">
                Créateur: <%= params[:creator_status] == 'with_movies' ? 'Avec films' : 'Sans films' %>
              </span>
            <% end %>

            <% if params[:activity].present? %>
              <span class="px-3 py-1 bg-purple-500/20 text-purple-400 rounded-full text-xs">
                Activité: <%= params[:activity] == 'active' ? 'Actifs' : 'Inactifs' %>
              </span>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</section>
