<%= form_with(model: [review.event || review.movie, review], local: true, class: "space-y-6") do |form| %>
  <% if review.errors.any? %>
    <div id="error_explanation" class="bg-red-50 text-red-500 px-4 py-3 rounded-md shadow">
      <h2 class="font-semibold mb-2"><%= pluralize(review.errors.count, "erreur") %> empÃªchent lâ€™enregistrement :</h2>
      <ul class="list-disc list-inside text-sm">
        <% review.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <!-- Rating field -->
  <div data-controller="rating" class="rating">
    <% 5.times do |i| %>
      <span 
        class="star" 
        data-rating-target="star" 
        data-action="mouseover->rating#highlight mouseout->rating#reset click->rating#select" 
        data-value="<%= i + 1 %>">
        &#9733;
      </span>
    <% end %>
    <%= form.hidden_field :rating, value: review.rating || 0, data: { rating_target: "input" } %>
  </div>

  <!-- Comment field -->
  <div>
    <%= form.label :comment, "Commentaire", class: "block text-sm font-medium text-white" %>
    <%= form.text_area :comment,
      rows: 5,
      placeholder: "Donnez votre avis...",
      class: "mt-2 block w-full rounded-md border px-3 py-2 shadow-sm bg-dark-500 text-white placeholder-gray-400 
      #{review.errors[:comment].any? ? 'border-red-400 focus:outline-red-600' : 'border-gray-400 focus:outline-gold-500'}" %>
  </div>

  <!-- Submit button -->
  <div>
    <%= form.submit review.new_record? ? "Laisser un commentaire" : "Mettre Ã  jour le commentaire",
      class: "inline-block bg-gold-500 hover:bg-gold-600 text-white font-semibold py-2 px-4 rounded-md transition cursor-pointer" %>
  </div>
<% end %>

<!-- Delete button (separate form) -->
<% unless review.new_record? %>
  <div class="mt-4">
    <%= button_to "ðŸ—‘ Supprimer le commentaire",
        [review.event || review.movie, review],
        method: :delete,
        data: { confirm: "ÃŠtes-vous sÃ»r de vouloir supprimer cet avis ?" },
        class: "inline-block bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded-md transition cursor-pointer" %>
  </div>
<% end %>
